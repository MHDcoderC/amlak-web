name: Build and Deploy

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4
      
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: Install dependencies
      run: npm ci
      
    - name: Build project
      run: npm run build
      env:
        NODE_ENV: production
        
    - name: Upload build artifacts
      uses: actions/upload-artifact@v4
      with:
        name: dist-files
        path: dist/
        
    - name: Create deployment summary
      run: |
        echo "## ðŸš€ Build Summary" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "âœ… **Build Status:** Successful" >> $GITHUB_STEP_SUMMARY
        echo "ðŸ“¦ **Build Output:** \`dist/\` directory" >> $GITHUB_STEP_SUMMARY
        echo "ðŸŒ **Live URL:** http://amlak.venusbox.ir/" >> $GITHUB_STEP_SUMMARY
        echo "ðŸ“± **PWA Ready:** Yes" >> $GITHUB_STEP_SUMMARY
        echo "ðŸ” **SEO Optimized:** Yes" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### ðŸ“Š Build Details:" >> $GITHUB_STEP_SUMMARY
        echo "- **Node.js Version:** 18" >> $GITHUB_STEP_SUMMARY
        echo "- **Build Tool:** Vite" >> $GITHUB_STEP_SUMMARY
        echo "- **Framework:** React 19" >> $GITHUB_STEP_SUMMARY
        echo "- **CSS Framework:** Tailwind CSS" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### ðŸŽ¯ Features Built:" >> $GITHUB_STEP_SUMMARY
        echo "- âœ… PWA Support" >> $GITHUB_STEP_SUMMARY
        echo "- âœ… SEO Optimization" >> $GITHUB_STEP_SUMMARY
        echo "- âœ… Responsive Design" >> $GITHUB_STEP_SUMMARY
        echo "- âœ… RTL Support" >> $GITHUB_STEP_SUMMARY
        echo "- âœ… Performance Optimized" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### ðŸ“ Files Generated:" >> $GITHUB_STEP_SUMMARY
        echo "- `dist/index.html` - Main HTML file" >> $GITHUB_STEP_SUMMARY
        echo "- `dist/assets/` - JavaScript and CSS bundles" >> $GITHUB_STEP_SUMMARY
        echo "- `dist/manifest.json` - PWA manifest" >> $GITHUB_STEP_SUMMARY
        echo "- `dist/sw.js` - Service Worker" >> $GITHUB_STEP_SUMMARY
        echo "- `dist/robots.txt` - SEO robots file" >> $GITHUB_STEP_SUMMARY
        echo "- `dist/sitemap.xml` - SEO sitemap" >> $GITHUB_STEP_SUMMARY
